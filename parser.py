def parse_osv(osv_text):
    lines = osv_text.split('\n')
    orders = {}
    in_nomenclature = False

    for line in lines:
        # Ищем начало блока с продуктами
        if "Номенклатура" in line:
            in_nomenclature = True
            continue
        if not in_nomenclature or not line.strip():
            continue
        if "Итого" in line:
            break

        # Извлекаем название и кредитовый оборот
        parts = [p.strip() for p in line.split('\t') if p.strip()]
        if not parts:
            continue

        # Название продукта - первый непустой элемент
        name = parts[0]
        # Ищем числа: кредитовый оборот обычно 4-е число в строке
        numbers = []
        for part in parts[1:]:
            # Удаляем разделители тысяч и преобразуем в число
            cleaned = part.replace(',', '').replace('.000', '')
            if cleaned.isdigit():
                numbers.append(int(cleaned))
        
        if len(numbers) >= 4:
            credit_quantity = numbers[3]  # 4-е число в строке
            orders[name] = credit_quantity

    return orders

# Пример использования
osv_text = """Avatar for Alikhan
Alikhan

объясни вот эту таблицу. что за значение внутри нее? это деньги в тг, или тыс тг, или просто колво продукции? что это

ТОО "Gold Сапа"

Оборотно-сальдовая ведомость по счету 1320  за 3 января 2025 г.

Выводимые данные:	Количество

Отбор:	Склады В группе из списка "Склад сырья (ОФ); НОФ Склад"

Счет		Сальдо на начало периода		Обороты за период		Сальдо на конец периода

Структурное подразделение		Дебет	Кредит	Дебет	Кредит	Дебет	Кредит
Номенклатура

1320		5,993.000		10,286.000	10,223.000	6,056.000

Головное подразделение		5,993.000		10,286.000	10,223.000	6,056.000

Баварский хлеб 450гр в упаковке				13.000	13.000

Багет Луковый 300гр в упаковке				57.000	57.000

Багет Новый 300гр в упаковке				302.000	302.000

Багет Отрубной 300гр в упаковке				60.000	60.000

Багет Премиум 350гр в упаковке				15.000	15.000

Батон Верный 400гр в упаковке				48.000	48.000

Батон Нарезной 400гр				280.000	280.000

Батон Нарезной 400гр в упаковке				55.000	55.000

Береке хлеб 420гр				118.000	118.000

Береке хлеб 420гр в упаковке				52.000	52.000

Блины с мясом 200гр.(3шт)		67.000			3.000	64.000

Блины с творогом 200гр.(3шт)		31.000			3.000	28.000

Блины со сгущенкой 200гр.(3шт)		69.000				69.000

Бородинский хлеб 300гр				401.000	401.000

Бородинский хлеб 300гр в упаковке				147.000	147.000

Булочка для гамбургера  штучно большой кунжутом				1,530.000	1,510.000	20.000

Булочка для хотдога штучно		58.000		196.000	222.000	32.000

Булочки в упаковке				27.000	27.000

Бэйгл штучно с кунжутом		10.000				10.000

Бэйгл штучно с подсолн		10.000				10.000

Вареники с творогом 500 гр в упаковке		3.000				3.000

Гречишный хлеб 350гр в упаковке				7.000	7.000

Датский хлеб 500гр				5.000	5.000

Датский хлеб 500гр в упаковке				26.000	26.000

Деревенский хлеб 500гр				10.000	10.000

Диетический хлеб 200гр				241.000	241.000

Диетический хлеб 200гр в упаковке				98.000	98.000

Домашний хлеб 600гр в упаковке				10.000	10.000

Жайлы хлеб 600гр				119.000	119.000

Жайлы хлеб 600гр в упаковке				46.000	46.000

Здоровье хлеб 400гр				5.000	5.000

Здоровье хлеб 400гр в упаковке				12.000	12.000

Зерновой солодовый хлеб 350гр в упаковке осн				7.000	7.000

Кекс с изюмом 130гр				48.000	10.000	38.000

Косичка с творогом шт 		3.000				3.000

Круассан классический  полуфабрикат		52.000				52.000

Круассан Миндальный 130 гр		4.000				4.000

Круассаны 320гр в упаковке (5шт)				22.000	20.000	2.000

Круассаны с сыром полуфабрикат 100 гр		20.000				20.000

Круассаны с шоколадом полуфабрикат 100 гр		141.000				141.000

Круассаны со сгущенкой  полуфабрикат  100 гр		182.000				182.000

Кукурузный хлеб 350гр в упаковке				2.000	2.000

Любимый хлеб 500гр				843.000	843.000

Любимый хлеб 500гр в упаковке				87.000	87.000

Немецкий хлеб 250гр в упаковке				7.000	7.000

Отрубной хлеб 450гр				217.000	217.000

Отрубной хлеб 450гр в упаковке				71.000	71.000

Печенье Баунти 380 гр		22.000			2.000	20.000

Печенье Кольцо с арахисом 400 гр		17.000			2.000	15.000

Печенье Курабье 380 гр		9.000			2.000	7.000

Печенье Маковка 400 гр		16.000			1.000	15.000

Печенье Пальчик в шоколаде 400 гр		26.000				26.000

Печенье Ржаное безглютеновое 400гр		11.000				11.000

Печенье Три шоколада 180 гр		7.000				7.000

Печенье Шоколадное 400 гр		11.000				11.000

Пирожок печеный с капустой шт 90 гр		510.000				510.000

Пирожок печеный с картошкой шт 90 гр		420.000				420.000

Пирожок печеный с курицей шт 90 гр		480.000				480.000

Плетенка с кунжутной посыпкой 400гр				85.000	85.000

Плетенка с кунжутной посыпкой 400гр в упаковке				20.000	20.000

Плетенка с маковой посыпкой 400гр				23.000	23.000

Плетенка с маковой посыпкой 400гр в упаковке				11.000	11.000

Пышка Венская 55 гр (шт)		2.000				2.000

Ржаной хлеб 450гр				114.000	114.000

Ржаной хлеб 450гр в упаковке				38.000	38.000

Самса с курицей замороженная 140гр		350.000				350.000

Самса с курицей замороженная 90гр		900.000				900.000

Самса с курицей уйгурская100гр		90.000			30.000	60.000

Самса с мясом замороженная 140гр		200.000				200.000

Самса с мясом замороженная 90гр		700.000			50.000	650.000

Самса с мясом уйгурская100гр		405.000			45.000	360.000

Самса с сыром замороженная 125 гр		200.000				200.000

Самса с сыром замороженная 90 гр		700.000				700.000

Семейный хлеб 600гр				235.000	235.000

Семейный хлеб 600гр в упаковке				99.000	99.000

Славянский хлеб 600гр в упаковке				6.000	6.000

Сосиска в тесте замороженная 130гр		150.000				150.000

Спорт Актив хлеб 350гр в упаковке				3.000	3.000

Столичный хлеб 450гр в упаковке				13.000	13.000

Сырники 150гр в упаковке 		80.000				80.000

Сэндвич Ассорти 250гр				69.000	69.000

Сэндвич с колбасой 250гр				24.000	24.000

Сэндвич с кунжутом шт 				50.000	50.000

Сэндвич с курицей 250гр				22.000	22.000

Сэндвич шт Панини				1,324.000	1,157.000	167.000

Сэндвичи в упаковке (3шт)				9.000	9.000

Тартин бездрожжевой 430 гр в упаковке				14.000	14.000

Тостовый хлеб 250гр в упаковке		10.000		12.000	12.000	10.000

Улитка с изюмом 100 гр		13.000				13.000

Улитка с орехом 100 гр		14.000				14.000

Формовой мини хлеб 300гр				274.000	274.000

Формовой мини хлеб 300гр в упаковке				104.000	104.000

Формовой хлеб 600гр				2,185.000	2,185.000

Формовой хлеб 600гр в упаковке				171.000	171.000

Хлеб Зерновой 430гр 				151.000	151.000

Хлеб Зерновой 430гр в упаковке  				9.000	9.000

Хлеб Чиабатта шт				16.000	16.000

Хот-дог				21.000	21.000

Итого		5,993.000		10,286.000	10,223.000	6,056.000


."""
orders_data = parse_osv(osv_text)
print(orders_data)
